(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{3236:function(e,r,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return i(1650)}])},5675:function(e,r,i){"use strict";var s=i(5893),a=i(6596),t=i(1046),n=i(8029),o=i(8186),l=i(8491),d=i(4831),u=i(3712),c=i(4506),h=i(980),m=i(2206),f=i(92),g=i(7294),p=i(1163),b=i(7179),x=i(1872),y=i(340);r.Z=()=>{let[e,r]=(0,g.useState)(""),[i,v]=(0,g.useState)(""),[w,j]=(0,g.useState)(!1),{signIn:F,signInWithGoogle:k}=(0,b.a)(),I=(0,p.useRouter)(),_=(0,a.p)(),handleSubmit=async r=>{r.preventDefault(),j(!0);try{if(!e||!i)throw Error("Please enter both email and password");console.log("SignInForm: Attempting login with email:",e);let r=await F(e,i);if(!r.user)throw Error("No user data received");if(!r.user.emailVerified){_({title:"Email not verified",description:"Please check your email for verification link",status:"warning",duration:5e3,isClosable:!0});return}console.log("SignInForm: Login successful, user:",r.user.email),_({title:"Success!",description:"You have been successfully signed in.",status:"success",duration:5e3,isClosable:!0}),I.push("/dashboard")}catch(r){console.error("SignInForm: Login error:",r);let e="Failed to sign in";if(r.code)switch(r.code){case"auth/invalid-email":e="Invalid email address";break;case"auth/user-disabled":e="This account has been disabled";break;case"auth/user-not-found":e="No account found with this email";break;case"auth/wrong-password":e="Incorrect password";break;case"auth/too-many-requests":e="Too many failed attempts. Please try again later";break;case"auth/operation-not-allowed":e="This sign-in method is not enabled. Please contact support.";break;default:e=r.message||"Failed to sign in"}_({title:"Error",description:e,status:"error",duration:5e3,isClosable:!0})}finally{j(!1)}},handleGoogleSignIn=async()=>{j(!0);try{console.log("SignInForm: Attempting Google sign in");let e=await k();console.log("SignInForm: Google sign in successful, user:",e.user.email),_({title:"Success!",description:"You have been successfully signed in with Google.",status:"success",duration:5e3,isClosable:!0}),I.push("/dashboard")}catch(r){console.error("SignInForm: Google sign in error:",r);let e=r.message||"Failed to sign in with Google";"auth/operation-not-allowed"===r.code&&(e="Google sign-in is not enabled. Please contact support."),_({title:"Error",description:e,status:"error",duration:5e3,isClosable:!0})}finally{j(!1)}},S=(0,t.ff)("white","gray.700"),C=(0,t.ff)("gray.200","gray.600");return(0,s.jsx)(n.x,{as:"form",onSubmit:handleSubmit,width:"100%",maxW:"400px",bg:S,p:8,borderRadius:"lg",boxShadow:"lg",border:"1px solid",borderColor:C,children:(0,s.jsxs)(o.g,{spacing:6,children:[(0,s.jsx)(l.z,{leftIcon:(0,s.jsx)(x.JM8,{}),w:"100%",onClick:handleGoogleSignIn,isLoading:w,mb:4,variant:"outline",_hover:{bg:"gray.50"},isDisabled:w,children:"Sign in with Google"}),(0,s.jsx)(d.i,{}),(0,s.jsxs)(u.K,{spacing:4,width:"100%",children:[(0,s.jsxs)(c.NI,{id:"email",isRequired:!0,children:[(0,s.jsx)(h.l,{children:"Email address"}),(0,s.jsx)(m.I,{type:"email",value:e,onChange:e=>r(e.target.value),placeholder:"Enter your email",isDisabled:w})]}),(0,s.jsxs)(c.NI,{id:"password",isRequired:!0,children:[(0,s.jsx)(h.l,{children:"Password"}),(0,s.jsx)(m.I,{type:"password",value:i,onChange:e=>v(e.target.value),placeholder:"Enter your password",isDisabled:w})]}),(0,s.jsx)(l.z,{type:"submit",colorScheme:"blue",width:"100%",isLoading:w,isDisabled:w,children:"Sign In"})]}),(0,s.jsxs)(f.x,{fontSize:"sm",color:"gray.500",textAlign:"center",children:["Don't have an account?"," ",(0,s.jsx)(y.Z,{href:"/signup",color:"blue.400",children:"Sign up"})]}),(0,s.jsx)(y.Z,{href:"/forgot-password",color:"blue.400",children:"Forgot Password?"})]})})}},1650:function(e,r,i){"use strict";i.r(r);var s=i(5893),a=i(8029),t=i(8186),n=i(232),o=i(92),l=i(5675),d=i(7179),u=i(1163),c=i(7294);r.default=()=>{let{user:e,loading:r}=(0,d.a)(),i=(0,u.useRouter)();return((0,c.useEffect)(()=>{!r&&e&&i.replace("/dashboard")},[e,r,i]),r||e)?null:(0,s.jsx)(a.x,{py:10,children:(0,s.jsxs)(t.g,{spacing:8,children:[(0,s.jsxs)(a.x,{textAlign:"center",children:[(0,s.jsx)(n.X,{size:"xl",mb:2,children:"Welcome Back"}),(0,s.jsx)(o.x,{color:"gray.600",children:"Sign in to access your threat intelligence dashboard"})]}),(0,s.jsx)(l.Z,{})]})})}},4831:function(e,r,i){"use strict";i.d(r,{i:function(){return d}});var s=i(5893),a=i(5544),t=i(4926),n=i(9381),o=i(6158),l=i(7430);let d=(0,n.G)(function(e,r){let{borderLeftWidth:i,borderBottomWidth:n,borderTopWidth:d,borderRightWidth:u,borderWidth:c,borderStyle:h,borderColor:m,...f}=(0,o.m)("Divider",e),{className:g,orientation:p="horizontal",__css:b,...x}=(0,a.L)(e);return(0,s.jsx)(l.m.hr,{ref:r,"aria-orientation":p,...x,__css:{...f,border:"0",borderColor:m,borderStyle:h,...{vertical:{borderLeftWidth:i||u||c||"1px",height:"100%"},horizontal:{borderBottomWidth:n||d||c||"1px",width:"100%"}}[p],...b},className:(0,t.cx)("chakra-divider",g)})});d.displayName="Divider"},4506:function(e,r,i){"use strict";i.d(r,{NI:function(){return b},NJ:function(){return p},e:function(){return f}});var s=i(5893),a=i(9062),t=i(5544),n=i(2110),o=i(397),l=i(4926),d=i(7294),u=i(9381),c=i(6158),h=i(7430);let[m,f]=(0,n.k)({name:"FormControlStylesContext",errorMessage:"useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in \"<FormControl />\" "}),[g,p]=(0,n.k)({strict:!1,name:"FormControlContext"}),b=(0,u.G)(function(e,r){let i=(0,c.j)("Form",e),n=(0,t.L)(e),{getRootProps:u,htmlProps:f,...p}=function(e){let{id:r,isRequired:i,isInvalid:s,isDisabled:t,isReadOnly:n,...l}=e,u=(0,d.useId)(),c=r||`field-${u}`,h=`${c}-label`,m=`${c}-feedback`,f=`${c}-helptext`,[g,p]=(0,d.useState)(!1),[b,x]=(0,d.useState)(!1),[y,v]=(0,d.useState)(!1),w=(0,d.useCallback)((e={},r=null)=>({id:f,...e,ref:(0,a.lq)(r,e=>{e&&x(!0)})}),[f]),j=(0,d.useCallback)((e={},r=null)=>({...e,ref:r,"data-focus":(0,o.P)(y),"data-disabled":(0,o.P)(t),"data-invalid":(0,o.P)(s),"data-readonly":(0,o.P)(n),id:void 0!==e.id?e.id:h,htmlFor:void 0!==e.htmlFor?e.htmlFor:c}),[c,t,y,s,n,h]),F=(0,d.useCallback)((e={},r=null)=>({id:m,...e,ref:(0,a.lq)(r,e=>{e&&p(!0)}),"aria-live":"polite"}),[m]),k=(0,d.useCallback)((e={},r=null)=>({...e,...l,ref:r,role:"group","data-focus":(0,o.P)(y),"data-disabled":(0,o.P)(t),"data-invalid":(0,o.P)(s),"data-readonly":(0,o.P)(n)}),[l,t,y,s,n]),I=(0,d.useCallback)((e={},r=null)=>({...e,ref:r,role:"presentation","aria-hidden":!0,children:e.children||"*"}),[]);return{isRequired:!!i,isInvalid:!!s,isReadOnly:!!n,isDisabled:!!t,isFocused:!!y,onFocus:()=>v(!0),onBlur:()=>v(!1),hasFeedbackText:g,setHasFeedbackText:p,hasHelpText:b,setHasHelpText:x,id:c,labelId:h,feedbackId:m,helpTextId:f,htmlProps:l,getHelpTextProps:w,getErrorMessageProps:F,getRootProps:k,getLabelProps:j,getRequiredIndicatorProps:I}}(n),b=(0,l.cx)("chakra-form-control",e.className);return(0,s.jsx)(g,{value:p,children:(0,s.jsx)(m,{value:i,children:(0,s.jsx)(h.m.div,{...u({},r),className:b,__css:i.container})})})});b.displayName="FormControl";let x=(0,u.G)(function(e,r){let i=p(),a=f(),t=(0,l.cx)("chakra-form__helper-text",e.className);return(0,s.jsx)(h.m.div,{...i?.getHelpTextProps(e,r),__css:a.helperText,className:t})});x.displayName="FormHelperText"},980:function(e,r,i){"use strict";i.d(r,{l:function(){return u}});var s=i(5893),a=i(5544),t=i(4926),n=i(4506),o=i(9381),l=i(6158),d=i(7430);let u=(0,o.G)(function(e,r){let i=(0,l.m)("FormLabel",e),o=(0,a.L)(e),{className:u,children:h,requiredIndicator:m=(0,s.jsx)(c,{}),optionalIndicator:f=null,...g}=o,p=(0,n.NJ)(),b=p?.getLabelProps(g,r)??{ref:r,...g};return(0,s.jsxs)(d.m.label,{...b,className:(0,t.cx)("chakra-form__label",o.className),__css:{display:"block",textAlign:"start",...i},children:[h,p?.isRequired?m:f]})});u.displayName="FormLabel";let c=(0,o.G)(function(e,r){let i=(0,n.NJ)(),a=(0,n.e)();if(!i?.isRequired)return null;let o=(0,t.cx)("chakra-form__required-indicator",e.className);return(0,s.jsx)(d.m.span,{...i?.getRequiredIndicatorProps(e,r),__css:a.requiredIndicator,className:o})});c.displayName="RequiredIndicator"},6013:function(e,r,i){"use strict";i.d(r,{K:function(){return useFormControlProps},Y:function(){return useFormControl}});var s=i(397),a=i(8928),t=i(4506);function useFormControl(e){let{isDisabled:r,isInvalid:i,isReadOnly:a,isRequired:t,...n}=useFormControlProps(e);return{...n,disabled:r,readOnly:a,required:t,"aria-invalid":(0,s.Q)(i),"aria-required":(0,s.Q)(t),"aria-readonly":(0,s.Q)(a)}}function useFormControlProps(e){let r=(0,t.NJ)(),{id:i,disabled:s,readOnly:n,required:o,isRequired:l,isInvalid:d,isReadOnly:u,isDisabled:c,onFocus:h,onBlur:m,...f}=e,g=e["aria-describedby"]?[e["aria-describedby"]]:[];return r?.hasFeedbackText&&r?.isInvalid&&g.push(r.feedbackId),r?.hasHelpText&&g.push(r.helpTextId),{...f,"aria-describedby":g.join(" ")||void 0,id:i??r?.id,isDisabled:s??c??r?.isDisabled,isReadOnly:n??u??r?.isReadOnly,isRequired:o??l??r?.isRequired,isInvalid:d??r?.isInvalid,onFocus:(0,a.v)(r?.onFocus,h),onBlur:(0,a.v)(r?.onBlur,m)}}},2206:function(e,r,i){"use strict";i.d(r,{I:function(){return u}});var s=i(5893),a=i(5544),t=i(4926),n=i(6013),o=i(9381),l=i(6158),d=i(7430);let u=(0,o.G)(function(e,r){let{htmlSize:i,...o}=e,u=(0,l.j)("Input",o),c=(0,a.L)(o),h=(0,n.Y)(c),m=(0,t.cx)("chakra-input",e.className);return(0,s.jsx)(d.m.input,{size:i,...h,__css:u.field,ref:r,className:m})});u.displayName="Input",u.id="Input"}},function(e){e.O(0,[994,774,888,179],function(){return e(e.s=3236)}),_N_E=e.O()}]);