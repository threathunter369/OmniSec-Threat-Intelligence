(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[483],{1915:function(a,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/threat-search",function(){return e(6330)}])},6330:function(a,t,e){"use strict";e.r(t),e.d(t,{default:function(){return ThreatSearch}});var r=e(5893),s=e(7294),i=e(6596),o=e(6254),l=e(8186),n=e(232),d=e(8029),c=e(243),u=e(2206),h=e(8491),v=e(8899),p=e(6657),f=e(8843),w=e(92),b=e(7066);let m="0122c836be03981f88c60fc6441a850c7850e00a4124d93175ab18a86915fc4e",g="92d64d67dc6a7469abd9f3486dd09a6607e2fabae1a94d0c7a5405d608e943751748429d1d83f1d4",x="4af3b267294c99b643da236a6aa1e6c6d280ab859821c6ebe5a0a7ce6ea4a43f";if(!m||!g||!x)throw Error("Missing required API keys. Please check your environment configuration.");let I={async checkIP(a){var t,e,r,s,i,o,l,n,d,c;let u=[];try{let s=await b.Z.get("https://www.virustotal.com/api/v3/ip_addresses/".concat(a),{headers:{"x-apikey":m}});if(!(null===(r=s.data)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:null===(t=e.attributes)||void 0===t?void 0:t.last_analysis_stats))throw Error("Invalid response from VirusTotal API");u.push({source:"VirusTotal",malicious:s.data.data.attributes.last_analysis_stats.malicious>0,confidence:s.data.data.attributes.last_analysis_stats.malicious/s.data.data.attributes.last_analysis_stats.total*100,details:s.data.data.attributes})}catch(a){if(console.error("VirusTotal API Error:",a),(null===(s=a.response)||void 0===s?void 0:s.status)===401)throw Error("Invalid VirusTotal API key");throw Error(a.message||"Error checking IP with VirusTotal")}try{let t=await b.Z.get("https://api.abuseipdb.com/api/v2/check",{params:{ipAddress:a,maxAgeInDays:90},headers:{Key:g}});if(!(null===(o=t.data)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.abuseConfidenceScore))throw Error("Invalid response from AbuseIPDB API");u.push({source:"AbuseIPDB",malicious:t.data.data.abuseConfidenceScore>50,confidence:t.data.data.abuseConfidenceScore,details:t.data.data})}catch(a){if(console.error("AbuseIPDB API Error:",a),(null===(l=a.response)||void 0===l?void 0:l.status)===401)throw Error("Invalid AbuseIPDB API key");throw Error(a.message||"Error checking IP with AbuseIPDB")}try{let t=await b.Z.get("https://otx.alienvault.com/api/v1/indicators/IPv4/".concat(a,"/general"),{headers:{"X-OTX-API-KEY":x}});if(!(null===(d=t.data)||void 0===d?void 0:null===(n=d.pulse_info)||void 0===n?void 0:n.count))throw Error("Invalid response from AlienVault OTX API");u.push({source:"AlienVault OTX",malicious:t.data.pulse_info.count>0,confidence:t.data.pulse_info.count>0?75:0,details:t.data})}catch(a){if(console.error("AlienVault OTX API Error:",a),(null===(c=a.response)||void 0===c?void 0:c.status)===401)throw Error("Invalid AlienVault OTX API key");throw Error(a.message||"Error checking IP with AlienVault OTX")}return u},async checkURL(a){var t,e,r,s;let i=[];try{let s=await b.Z.post("https://www.virustotal.com/api/v3/urls","url=".concat(encodeURIComponent(a)),{headers:{"x-apikey":m,"content-type":"application/x-www-form-urlencoded"}}),o=s.data.data.id,l=await b.Z.get("https://www.virustotal.com/api/v3/analyses/".concat(o),{headers:{"x-apikey":m}});if(!(null===(r=l.data)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:null===(t=e.attributes)||void 0===t?void 0:t.stats))throw Error("Invalid response from VirusTotal API");i.push({source:"VirusTotal",malicious:l.data.data.attributes.stats.malicious>0,confidence:l.data.data.attributes.stats.malicious/l.data.data.attributes.stats.total*100,details:l.data.data.attributes})}catch(a){if(console.error("VirusTotal API Error:",a),(null===(s=a.response)||void 0===s?void 0:s.status)===401)throw Error("Invalid VirusTotal API key");throw Error(a.message||"Error checking URL with VirusTotal")}return i},async checkHash(a){var t,e,r,s;let i=[];try{let s=await b.Z.get("https://www.virustotal.com/api/v3/files/".concat(a),{headers:{"x-apikey":m}});if(!(null===(r=s.data)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:null===(t=e.attributes)||void 0===t?void 0:t.last_analysis_stats))throw Error("Invalid response from VirusTotal API");i.push({source:"VirusTotal",malicious:s.data.data.attributes.last_analysis_stats.malicious>0,confidence:s.data.data.attributes.last_analysis_stats.malicious/s.data.data.attributes.last_analysis_stats.total*100,details:s.data.data.attributes})}catch(a){if(console.error("VirusTotal API Error:",a),(null===(s=a.response)||void 0===s?void 0:s.status)===401)throw Error("Invalid VirusTotal API key");throw Error(a.message||"Error checking hash with VirusTotal")}return i}};function ThreatSearch(){let[a,t]=(0,s.useState)("ip"),[e,b]=(0,s.useState)(""),[m,g]=(0,s.useState)(!1),[x,y]=(0,s.useState)([]),[E,P]=(0,s.useState)(""),A=(0,i.p)(),handleSearch=async()=>{if(!e){A({title:"Error",description:"Please enter a value to search",status:"error",duration:3e3,isClosable:!0});return}g(!0),P(""),y([]);try{let t;switch(a){case"ip":t=await I.checkIP(e);break;case"url":t=await I.checkURL(e);break;case"hash":t=await I.checkHash(e);break;default:throw Error("Invalid search type")}t&&t.length>0?y(t):P("No results found for the given search term")}catch(t){console.error("Search error:",t);let a=t.message||"An unexpected error occurred";P(a),A({title:"Error",description:a,status:"error",duration:5e3,isClosable:!0})}finally{g(!1)}};return(0,r.jsx)(o.W,{maxW:"container.xl",py:8,children:(0,r.jsxs)(l.g,{spacing:6,align:"stretch",children:[(0,r.jsx)(n.X,{as:"h1",size:"xl",mb:6,children:"Threat Intelligence Search"}),(0,r.jsx)(d.x,{bg:"white",p:6,borderRadius:"md",shadow:"md",children:(0,r.jsxs)(l.g,{spacing:4,children:[(0,r.jsxs)(c.P,{value:a,onChange:a=>t(a.target.value),children:[(0,r.jsx)("option",{value:"ip",children:"IP Address"}),(0,r.jsx)("option",{value:"url",children:"URL"}),(0,r.jsx)("option",{value:"hash",children:"File Hash"})]}),(0,r.jsx)(u.I,{placeholder:"Enter ".concat(a.toUpperCase()," to search"),value:e,onChange:a=>b(a.target.value)}),(0,r.jsx)(h.z,{colorScheme:"blue",onClick:handleSearch,isLoading:m,loadingText:"Searching...",width:"full",children:"Search"})]})}),m&&(0,r.jsx)(d.x,{textAlign:"center",py:4,children:(0,r.jsx)(v.$,{size:"xl"})}),E&&(0,r.jsxs)(p.b,{status:"error",children:[(0,r.jsx)(f.z,{}),E]}),x.length>0&&(0,r.jsxs)(d.x,{bg:"white",p:6,borderRadius:"md",shadow:"md",children:[(0,r.jsx)(n.X,{size:"md",mb:4,children:"Results"}),(0,r.jsx)(l.g,{spacing:4,align:"stretch",children:x.map((a,t)=>(0,r.jsxs)(d.x,{p:4,borderWidth:1,borderRadius:"md",borderColor:a.malicious?"red.200":"green.200",bg:a.malicious?"red.50":"green.50",children:[(0,r.jsxs)(w.x,{fontWeight:"bold",children:["Source: ",a.source]}),(0,r.jsxs)(w.x,{children:["Status: ",a.malicious?"Malicious":"Clean"]}),(0,r.jsxs)(w.x,{children:["Confidence: ",Math.round(100*a.confidence),"%"]}),a.details&&(0,r.jsxs)(w.x,{children:["Additional Details: ",JSON.stringify(a.details,null,2)]})]},t))})]})]})})}}},function(a){a.O(0,[806,774,888,179],function(){return a(a.s=1915)}),_N_E=a.O()}]);