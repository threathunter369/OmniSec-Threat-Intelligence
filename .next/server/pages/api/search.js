"use strict";(()=>{var a={};a.id=198,a.ids=[198],a.modules={145:a=>{a.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},467:(a,s,i)=>{i.r(s),i.d(s,{config:()=>n,default:()=>l,routeModule:()=>c});var t={};i.r(t),i.d(t,{default:()=>handler});var e=i(1802),r=i(7153),o=i(6249);let u={urls:{"malicious.com":{risk:"high",reason:"Known phishing domain"},"suspicious.net":{risk:"medium",reason:"Suspicious activity reported"}},ips:{"192.168.1.100":{risk:"high",reason:"Command & Control server"},"10.0.0.50":{risk:"medium",reason:"Suspicious traffic patterns"}},hashes:{a1b2c3d4:{risk:"critical",reason:"Known ransomware variant"},e5f6g7h8:{risk:"high",reason:"Malicious file signature"}},domains:{"evil.com":{risk:"critical",reason:"Active malware distribution"},"sketchy.org":{risk:"medium",reason:"Reported suspicious activity"}}},simulateApiDelay=()=>new Promise(a=>setTimeout(a,1e3)),searchUrl=async a=>{await simulateApiDelay();let s=u.urls[a]||{risk:"low",reason:"No threats detected"};return{data:{attributes:{last_analysis_stats:{malicious:"high"===s.risk?10:"medium"===s.risk?5:0,suspicious:"high"===s.risk?5:"medium"===s.risk?3:0,total:20},threat_details:s.reason}}}},searchIp=async a=>{await simulateApiDelay();let s=u.ips[a]||{risk:"low",reason:"No threats detected"};return{abuseipdb:{data:{abuseConfidenceScore:"high"===s.risk?90:"medium"===s.risk?50:0,domain:a,totalReports:"high"===s.risk?15:"medium"===s.risk?5:0,lastReportedAt:new Date().toISOString()}},alienvault:{pulse_info:{count:"high"===s.risk?10:"medium"===s.risk?5:0},reputation:"high"===s.risk?-5:"medium"===s.risk?-2:0}}},searchHash=async a=>{await simulateApiDelay();let s=u.hashes[a]||{risk:"low",reason:"No threats detected"};return{data:{attributes:{last_analysis_stats:{malicious:"critical"===s.risk?15:"high"===s.risk?10:0,suspicious:"critical"===s.risk?8:"high"===s.risk?5:0,total:25},threat_details:s.reason}}}},searchDomain=async a=>{await simulateApiDelay();let s=u.domains[a]||{risk:"low",reason:"No threats detected"};return{virustotal:{data:{attributes:{last_analysis_stats:{malicious:"critical"===s.risk?20:"high"===s.risk?10:"medium"===s.risk?5:0,suspicious:"critical"===s.risk?10:"high"===s.risk?5:"medium"===s.risk?3:0,total:30}}}},alienvault:{pulse_info:{count:"critical"===s.risk?15:"high"===s.risk?8:"medium"===s.risk?4:0},reputation:"critical"===s.risk?-8:"high"===s.risk?-5:"medium"===s.risk?-2:0}}};async function handler(a,s){if("POST"!==a.method)return s.status(405).json({message:"Method not allowed"});let{query:i}=a.body;if(!i)return s.status(400).json({message:"Query is required"});try{let a={};if(/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/.test(i)&&(a.url=await searchUrl(i)),/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(i)&&(a.ip=await searchIp(i)),/^[a-fA-F0-9]{32}$|^[a-fA-F0-9]{40}$|^[a-fA-F0-9]{64}$/.test(i)&&(a.hash=await searchHash(i)),/^(?!:\/\/)([a-zA-Z0-9-_]+\.)*[a-zA-Z0-9][a-zA-Z0-9-_]+\.[a-zA-Z]{2,11}?$/.test(i)&&(a.domain=await searchDomain(i)),0===Object.keys(a).length)try{a.domain=await searchDomain(i)}catch(a){console.error("Error searching as domain:",a)}let t={query:i,timestamp:new Date().toISOString(),results:a,summary:{threatLevel:function(a){let s=0,i=0;if(a.ip?.abuseipdb&&(s+=a.ip.abuseipdb.data.abuseConfidenceScore,i+=100),a.url?.data?.attributes?.last_analysis_stats){let t=a.url.data.attributes.last_analysis_stats;s+=(t.malicious+t.suspicious)*25,i+=25*t.total}if(a.domain?.virustotal?.data?.attributes?.last_analysis_stats){let t=a.domain.virustotal.data.attributes.last_analysis_stats;s+=(t.malicious+t.suspicious)*25,i+=25*t.total}let t=i>0?s/i*100:0;return t>=75?"critical":t>=50?"high":t>=25?"medium":"low"}(a),recommendations:function(a){let s=[];return a.ip?.abuseipdb?.data?.abuseConfidenceScore>50&&s.push("Block this IP address in your firewall"),a.url?.data?.attributes?.last_analysis_stats?.malicious>0&&s.push("Add this URL to your block list"),a.domain?.virustotal?.data?.attributes?.last_analysis_stats?.malicious>0&&s.push("Review and potentially block this domain"),a.hash?.data?.attributes?.last_analysis_stats?.malicious>0&&s.push("Quarantine files with this hash"),0===s.length&&s.push("No immediate actions required, continue monitoring"),s}(a)}};return s.status(200).json(t)}catch(a){return console.error("Search error:",a),s.status(500).json({message:"Error processing search",error:a.message})}}let l=(0,o.l)(t,"default"),n=(0,o.l)(t,"config"),c=new e.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/search",pathname:"/api/search",bundlePath:"",filename:""},userland:t})}};var s=require("../../webpack-api-runtime.js");s.C(a);var __webpack_exec__=a=>s(s.s=a),i=s.X(0,[222],()=>__webpack_exec__(467));module.exports=i})();